{"version":3,"names":["formatNewContent","formatBlockErrorMessage","validateChatHistory","generateContent","generateContentStream","logger","SILENT_ERROR","ChatSession","_history","_sendPromise","Promise","resolve","constructor","apiSettings","model","params","requestOptions","_apiSettings","history","getHistory","sendMessage","request","newContent","generateContentRequest","safetySettings","generationConfig","tools","toolConfig","systemInstruction","contents","finalResult","then","result","response","candidates","length","push","responseContent","parts","content","role","blockErrorMessage","warn","sendMessageStream","streamPromise","catch","_ignored","Error","streamResult","e","message","error"],"sourceRoot":"../../../lib","sources":["methods/chat-session.ts"],"mappings":"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","ignoreList":[]}
