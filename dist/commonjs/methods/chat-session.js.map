{"version":3,"names":["_requestHelpers","require","_responseHelpers","_chatSessionHelpers","_generateContent","_logger","SILENT_ERROR","ChatSession","_history","_sendPromise","Promise","resolve","constructor","apiSettings","model","params","requestOptions","_apiSettings","history","validateChatHistory","getHistory","sendMessage","request","newContent","formatNewContent","generateContentRequest","safetySettings","generationConfig","tools","toolConfig","systemInstruction","contents","finalResult","then","generateContent","result","response","candidates","length","push","responseContent","parts","content","role","blockErrorMessage","formatBlockErrorMessage","logger","warn","sendMessageStream","streamPromise","generateContentStream","catch","_ignored","Error","streamResult","e","message","error","exports"],"sourceRoot":"../../../lib","sources":["methods/chat-session.ts"],"mappings":"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","ignoreList":[]}
